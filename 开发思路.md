2023-10-31 晚上

风险值的计算：	

​				**综合分析排名  页面**

1. 初始加载 fetchData(), 先请求上个月的统计数据（sql语句查询的是type=month的数据），再请求上个月的异常数据。

2. 遍历分析数据数组。

   2.1. 对于分析数据数组中的元素a,,从异常数据中找出所有设备编号等于a的设备编号的数据b。

   2.2. 根据a得到在线，有效率，超标率

   2.3. 根据b计算得到复现率。

   2.4. 根据2.2和2.3的值得到该设备编号的风险值



​						**数据风险模型  页面**

1. 请求上月的统计数据（sql语句查询的是type=day的数据）,在请求上个月某站点的异常数据。
2. 遍历分析数据数据，累加平均值，在线率，有效率，超标率。遍历结束后除以月的天数得到月平均值，月在线率，月有效率，月超标率
3. 遍历某站点的异常数据，统计量级突变，超标临近，超标次数临界异常出现的次数，得到异常类型聚集度和复现率



1. 计算风险值时候，页面是按月份中有数据的时间段来计算。导致分母不足一个月，与综合风险排名页面按月来计算的不一样



2023-11-1  晚上

**数据风险模型页面加载逻辑**

1. 组件有参数传入时：站点名字，月份

   1. 页面根据这两个参数更新 统计数据 ，排名清单

2. 组件未接受到参数传入时

   初始加载：

   判断无参数传入时：才执行mounted

   1. 先得出排名清单

   2. 拿到最高站点的一个站点

   3. 页面根据该站点和时间更新 统计数据 

      ​

   4. 点击搜索按钮，会更新统计数据，也会更新排名清单，但不会把最高风险值赋值给输入框。

   5. 点击风险详情，只会更新统计数据，不更排名清单

抽象出的操作：

         	  1. 得出前10风险排名清单，返回值为最高的站点
         	  2. 统计数据（日数据）
         	  3. 异常统计（日数据）
         	  4. 计算风险值（独立模块，与2,3的结果无关。是与综合风险排名页面的月数据计算一致的）





w







